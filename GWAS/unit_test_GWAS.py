import unittest
import os
import GWA
from collections import Counter, defaultdict
import sys
import os
import errno
#import fileinput
import argparse
#import gzip
GROUPHOME = os.environ['GROUPHOME']
import pickle
import glob
from os import listdir
from os.path import isfile
import itertools
import filecmp

#GROUPHOME = os.environ['GROUPHOME']
#dst_file = open('dst.txt')

class TestStringMethods(unittest.TestCase):

    def test_R_or_S(self):
        self.assertEqual(GWA.get_R_or_S('1-0019','dst_file','pza'), 'R')
        self.assertEqual(GWA.get_R_or_S('1-0019','dst_file','fq'), 'R')
        self.assertEqual(GWA.get_R_or_S('11097-03','dst_file','inh'), 'S')
        self.assertEqual(GWA.get_R_or_S('C00018880','dst_file','ofx'), 'S')

    def test_counts(self):
        self.assertListEqual(GWA.count_variation(dst_file,bed_range,isolates,'pza',False,'gene','unittest_output'),expected_output1)
        self.assertListEqual(GWA.count_variation(dst_file,bed_range,isolates,'inh',False,'mutation','unittest_output'),expected_output2)
    def test_split(self):
        s = 'hello world'
        self.assertEqual(s.split(), ['hello', 'world'])
        # check that s.split fails when the separator is not a string
        with self.assertRaises(TypeError):
            s.split(2)

if __name__ == '__main__':

    dst_file = open('dst.txt')
    header = dst_file.readline()
    # get the list of all the isolates from the dst file
    all_islts_dst, dup_mutation, dup_mut = [], [], []
    global arg_drug
    arg_drug='pza'
    expected_output1=['Gene\t Total Number R (unique) [isolate count]\t Total Number S (unique) [isolate count]\t# R with mutations that No S has [isolate count, subset of Col2]\t# S with mutations that No R has [isolate count, subset of Col3]\t# of unique mutations\t # Mutations that only R has [mutation count]\t # Mutations that only S has [mutation count]\n', 'fadE1\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0133\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'pepA\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0093c\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'Rv0138\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0108c_prom\t3\t0\t3\t0\t1\t1\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0149\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'hddA\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'Rv0076c\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'PPE1\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'PE_PGRS1\t3\t0\t3\t0\t2\t2\t0\tSEA13111,SEA14318,SEA14117\n', 'treS\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0095c\t3\t0\t3\t0\t20\t20\t0\tSEA13111,SEA14318,SEA14117\n', 'gca\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'Rv0064\t3\t0\t3\t0\t1\t1\t0\tSEA13111,SEA14318,SEA14117\n', 'mak_prom\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'oxyS_prom\t2\t0\t2\t0\t2\t2\t0\tSEA13111,SEA14318\n', 'Rv0097\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'PE2_prom\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'Rv0145_prom\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0094c_prom\t3\t0\t3\t0\t10\t10\t0\tSEA13111,SEA14318,SEA14117\n', 'mce1R\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n', 'pntB\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'Rv0146\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'fusA2\t3\t0\t3\t0\t4\t4\t0\tSEA13111,SEA14318,SEA14117\n', 'ctpA\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'oxcA\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0102\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'ctpB\t3\t0\t3\t0\t2\t2\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0147\t2\t0\t2\t0\t2\t2\t0\tSEA13111,SEA14318\n', 'Rv0142\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'Rv0089\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'ctpI\t3\t0\t3\t0\t4\t4\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0150c_prom\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'Rv0082\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'Rv0083\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0080\t2\t0\t2\t0\t2\t2\t0\tSEA13111,SEA14318\n', 'Rv0081\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'ctpI_prom\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'fadD7\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'Rv0143c\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'sdaA\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0161\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'fadD5\t3\t0\t3\t0\t2\t2\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0071_prom\t2\t0\t2\t0\t2\t2\t0\tSEA13111,SEA14318\n', 'Rv0104\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n', 'gca_prom\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'Rv0128\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'msrA\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0161_prom\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'Rv0144\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'mce1A\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0090_prom\t1\t0\t1\t0\t1\t1\t0\tSEA14318\n', 'Rv0094c\t3\t0\t3\t0\t16\t16\t0\tSEA13111,SEA14318,SEA14117\n', 'mak\t3\t0\t3\t0\t1\t1\t0\tSEA13111,SEA14318,SEA14117\n', 'nrp\t3\t0\t3\t0\t4\t4\t0\tSEA13111,SEA14318,SEA14117\n', 'ephF\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n', 'cyp138\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'yrbE1B\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'Rv0072_prom\t2\t0\t2\t0\t2\t2\t0\tSEA13111,SEA14318\n', 'oxyS\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'yrbE1A\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'PE4\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'Rv0089_prom\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'PE1\t3\t0\t3\t0\t2\t2\t0\tSEA13111,SEA14318,SEA14117\n', 'fadD10\t1\t0\t1\t0\t2\t2\t0\tSEA13111\n', 'PE3\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0078A\t1\t0\t1\t0\t1\t1\t0\tSEA14117\n', 'Rv0071\t2\t0\t2\t0\t1\t1\t0\tSEA13111,SEA14318\n', 'Rv0111_prom\t3\t0\t3\t0\t1\t1\t0\tSEA13111,SEA14318,SEA14117\n', 'Rv0075\t1\t0\t1\t0\t1\t1\t0\tSEA13111\n', 'Rv0074\t2\t0\t2\t0\t2\t2\t0\tSEA13111,SEA14318\n', 'Rv0079\t2\t0\t2\t0\t2\t2\t0\tSEA13111,SEA14318\n', 'Rv0090\t3\t0\t3\t0\t3\t3\t0\tSEA13111,SEA14318,SEA14117\n']
    expected_output2=['gene\tmutation\tconsequence\tposition\tR\tS\n', 'ephF\tW152*\tstop_gained\t162226\t0\t2\tSEA13111,SEA14318\n', 'fusA2\tN562S\tmissense_variant\t146087\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'fadD5\tN550\tsynonymous_variant\t196642\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'fadE1\tF324S\tmissense_variant\t158688\t0\t1\tSEA14318\n', 'fadD5\tD510\tsynonymous_variant\t196522\t0\t1\t10206-03\n', 'nrp\tV2078A\tmissense_variant\t116233\t0\t1\tSEA14318\n', 'Rv0095c\tF51\tsynonymous_variant\t105063\t0\t2\t10206-03,SEA14318\n', 'Rv0072_prom\tC-115T\tupstream_gene_variant\t80509\t0\t1\tSEA14318\n', 'Rv0095c\tE133D\tmissense_variant\t104817\t0\t1\tSEA14117\n', 'Rv0095c\tR129L\tmissense_variant\t104830\t0\t1\tSEA14117\n', 'Rv0095c\tA408-409AG\tframeshift_variant\t104807\t0\t1\tSEA14117\n', 'Rv0147\tR324H\tmissense_variant\t174208\t0\t1\tSEA14318\n', 'Rv0083\tT600\tsynonymous_variant\t92199\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'Rv0095c\t*137S\tstop_lost\t104806\t0\t1\tSEA14117\n', 'fadD10\tP10L\tmissense_variant\t108184\t0\t1\tSEA13111\n', 'Rv0095c\tD57E\tmissense_variant\t105045\t0\t3\t10206-03,SEA13111,SEA14318\n', 'hddA\tA1044-1045AC\tframeshift_variant\t139556\t0\t2\tSEA13111,SEA14318\n', 'Rv0111_prom\tG-88A\tupstream_gene_variant\t133862\t0\t1\t10206-03\n', 'fadD10\tS62L\tmissense_variant\t108340\t0\t1\tSEA13111\n', 'Rv0095c\tQ92E\tmissense_variant\t104942\t0\t1\t10206-03\n', 'Rv0064\tR906P\tmissense_variant\t71336\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'Rv0143c\tV466I\tmissense_variant\t168787\t0\t2\tSEA13111,SEA14318\n', 'oxcA\tD29A\tmissense_variant\t143791\t0\t1\tSEA13111\n', 'Rv0094c_prom\tC-49T\tupstream_gene_variant\t104712\t0\t3\t10207-03,SEA13111,SEA14318\n', 'Rv0095c\tE126D\tmissense_variant\t104838\t0\t1\tSEA14117\n', 'Rv0095c\tS131I\tmissense_variant\t104824\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'Rv0095c\tA91V+Q92G\tmissense_variant\t104940\t0\t1\tSEA14117\n', 'Rv0094c\tL64\tsynonymous_variant\t104472\t0\t2\tSEA13111,SEA14318\n', 'PE_PGRS1\tR346G\tmissense_variant\t132417\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'Rv0095c\tL99\tsynonymous_variant\t104919\t0\t2\t10206-03,SEA14318\n', 'fusA2\tY176C\tmissense_variant\t147245\t0\t1\t10206-03\n', 'fadD7\tI172\tsynonymous_variant\t144564\t0\t2\tSEA13111,SEA14318\n', 'ctpI\tL255M\tmissense_variant\t129779\t0\t1\tSEA13111\n', 'Rv0161\tS70\tsynonymous_variant\t190816\t0\t1\tSEA14117\n', 'Rv0161_prom\tC-68A\tupstream_gene_variant\t190539\t0\t1\tSEA13111\n', 'Rv0095c\tQ92G\tmissense_variant\t104941\t0\t1\tSEA14318\n', 'oxyS_prom\tA-1246C\tupstream_gene_variant\t139954\t0\t2\tSEA13111,SEA14318\n', 'ephF\tGT382G\tframeshift_variant\t162151\t0\t1\tSEA14117\n', 'ctpI\tS1247P\tmissense_variant\t126803\t0\t2\tSEA13111,SEA14318\n', 'nrp\tV2000\tsynonymous_variant\t116000\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'Rv0094c_prom\tC-128T\tupstream_gene_variant\t104791\t0\t1\tSEA14117\n', 'Rv0140\tV112I\tmissense_variant\t167243\t0\t1\t10206-03\n', 'sdaA\tG52S\tmissense_variant\t77469\t0\t1\tSEA14318\n', 'ctpA\tR539L\tmissense_variant\t102198\t0\t1\tSEA13111\n', 'mak_prom\tA-41G\tupstream_gene_variant\t154191\t0\t2\tSEA13111,SEA14318\n', 'Rv0093c\tC22R\tmissense_variant\t103600\t0\t2\tSEA13111,SEA14318\n', 'yrbE1B\tD218E\tmissense_variant\t198313\t0\t1\tSEA14117\n', 'Rv0094c\tR127\tsynonymous_variant\t104283\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'Rv0094c_prom\tC-104T\tupstream_gene_variant\t104767\t0\t1\tSEA14117\n', 'oxcA\tS224G\tmissense_variant\t143207\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'ctpI\tG4711-4712GA\tframeshift_variant\t125830\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'Rv0094c_prom\tA-122G\tupstream_gene_variant\t104785\t0\t1\tSEA14117\n', 'Rv0081\tA65S\tmissense_variant\t89767\t0\t1\t10207-03\n', 'ctpI\tG1422\tsynonymous_variant\t126276\t0\t1\tSEA13111\n', 'Rv0095c\tCTT403-404C\tframeshift_variant\t104811\t0\t1\tSEA14117\n', 'treS\tG576\tsynonymous_variant\t154051\t0\t1\tSEA14318\n', 'Rv0071\tT19-20TCGGTGGACCCGGTGGACC\tinframe_insertion\t79504\t0\t2\tSEA13111,SEA14318\n', 'Rv0094c\tN276K\tmissense_variant\t103836\t0\t2\tSEA13111,SEA14318\n', 'PE2_prom\tC-118G\tupstream_gene_variant\t181014\t0\t1\tSEA13111\n', 'PE_PGRS1\tG422V\tmissense_variant\t132646\t0\t2\tSEA13111,SEA14318\n', 'Rv0108c_prom\tT-70TG\tupstream_gene_variant\t131174\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'PE2\tG291E\tmissense_variant\t180025\t0\t1\t10206-03\n', 'Rv0090\tG58R\tmissense_variant\t98651\t0\t1\tSEA13111\n', 'oxyS\tA230\tsynonymous_variant\t141889\t0\t1\tSEA14117\n', 'PE4\tK164N\tmissense_variant\t189948\t0\t2\tSEA13111,SEA14318\n', 'Rv0074\tCCG702-703C\tframeshift_variant\t83448\t0\t1\tSEA14318\n', 'ephF\tG245\tsynonymous_variant\t162505\t0\t1\tSEA14117\n', 'Rv0094c_prom\tC-110T\tupstream_gene_variant\t104773\t0\t1\tSEA14117\n', 'fadD7\tS408Y\tmissense_variant\t145271\t0\t1\t10206-03\n', 'oxcA\tA520\tsynonymous_variant\t142317\t0\t1\t10207-03\n', 'Rv0102\tA252\tsynonymous_variant\t118469\t0\t1\t10207-03\n', 'ctpB\tA310V\tmissense_variant\t121245\t0\t1\tSEA14318\n', 'Rv0080\tK67N\tmissense_variant\t89222\t0\t1\tSEA13111\n', 'Rv0095c\tT94A\tmissense_variant\t104936\t0\t1\tSEA14117\n', 'Rv0094c\tR63\tsynonymous_variant\t104475\t0\t2\tSEA13111,SEA14318\n', 'oxcA\tP375A\tmissense_variant\t142754\t0\t1\tSEA14318\n', 'PE1\tR390W\tmissense_variant\t178142\t0\t1\tSEA14318\n', 'Rv0094c\tD291N\tmissense_variant\t103793\t0\t1\tSEA13111\n', 'pepA\tL130\tsynonymous_variant\t151535\t0\t1\t10207-03\n', 'msrA\tP149\tsynonymous_variant\t164814\t0\t1\tSEA14318\n', 'PPE1\tV138A\tmissense_variant\t105736\t0\t1\tSEA14117\n', 'Rv0072_prom\tC-8G\tupstream_gene_variant\t80616\t0\t4\t10206-03,10207-03,SEA13111,SEA14318\n', 'fusA2\tV328\tsynonymous_variant\t146788\t0\t2\tSEA13111,SEA14318\n', 'Rv0097\tE8D\tmissense_variant\t106757\t0\t1\tSEA14318\n', 'Rv0094c_prom\tC-131T\tupstream_gene_variant\t104794\t0\t1\tSEA14117\n', 'PE3\tA810-811AG\tframeshift_variant\t188029\t0\t1\tSEA13111\n', 'gca_prom\tG-256T\tupstream_gene_variant\t136033\t0\t1\tSEA13111\n', 'Rv0146\tS152P\tmissense_variant\t172664\t0\t1\tSEA14318\n', 'Rv0104\tP235\tsynonymous_variant\t123021\t0\t1\tSEA13111\n', 'Rv0150c_prom\tG-198C\tupstream_gene_variant\t177150\t0\t1\tSEA13111\n', 'Rv0111_prom\tC-111T\tupstream_gene_variant\t133839\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'nrp\tS2432N\tmissense_variant\t117295\t0\t1\tSEA13111\n', 'Rv0142\tD92\tsynonymous_variant\t167986\t0\t2\tSEA13111,SEA14318\n', 'nrp\tG96\tsynonymous_variant\t110288\t0\t1\t10206-03\n', 'cyp138\tCATGTCGCGCAAGG751-763C\tframeshift_variant\t164115\t0\t1\tSEA14117\n', 'Rv0089\tA65\tsynonymous_variant\t97952\t0\t1\tSEA13111\n', 'Rv0082\tE63G\tmissense_variant\t90111\t0\t1\tSEA14117\n', 'Rv0094c\tCT42C\tframeshift_variant\t104621\t0\t1\tSEA14117\n', 'Rv0094c\tH275R\tmissense_variant\t103840\t0\t2\tSEA13111,SEA14318\n', 'mak\tS18P\tmissense_variant\t154283\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'Rv0094c_prom\tTT-137AG\tupstream_gene_variant\t104800\t0\t1\tSEA14117\n', 'Rv0102\tF484Y\tmissense_variant\t119164\t0\t1\t10206-03\n', 'Rv0076c\tE82D\tmissense_variant\t85327\t0\t1\tSEA14318\n', 'Rv0149\tV99I\tmissense_variant\t175994\t0\t1\tSEA14117\n', 'Rv0094c\tC231\tsynonymous_variant\t103971\t0\t2\tSEA13111,SEA14318\n', 'Rv0083\tR543\tsynonymous_variant\t92028\t0\t1\tSEA14318\n', 'Rv0079\tY160\tsynonymous_variant\t88683\t0\t1\tSEA13111\n', 'Rv0094c\tA128\tsynonymous_variant\t104280\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'PE3\tA28T\tmissense_variant\t188758\t0\t1\tSEA14318\n', 'fbpC\tE103\tsynonymous_variant\t157292\t0\t1\t10206-03\n', 'Rv0071_prom\tC-204CCCACAT\tupstream_gene_variant\t79281\t0\t2\tSEA13111,SEA14318\n', 'mce1A\tV442I\tmissense_variant\t199857\t0\t1\tSEA13111\n', 'Rv0095c\tA85V\tmissense_variant\t104962\t0\t3\t10206-03,SEA14318,SEA14117\n', 'Rv0147\tA175G\tmissense_variant\t173761\t0\t1\tSEA13111\n', 'ctpA\tA105S\tmissense_variant\t100895\t0\t1\t10207-03\n', 'mce1A\tV442\tsynonymous_variant\t199859\t0\t1\tSEA13111\n', 'gca\tA315\tsynonymous_variant\t137233\t0\t2\tSEA13111,SEA14318\n', 'Rv0104\tL387V\tmissense_variant\t123475\t0\t1\t10207-03\n', 'Rv0139\tT174\tsynonymous_variant\t166348\t0\t1\t10207-03\n', 'Rv0083\tA417V\tmissense_variant\t91649\t0\t1\tSEA14117\n', 'Rv0075\tF178C\tmissense_variant\t84528\t0\t1\tSEA13111\n', 'Rv0104\tY402H\tmissense_variant\t123520\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'Rv0095c\tD52\tsynonymous_variant\t105060\t0\t2\t10206-03,SEA14318\n', 'yrbE1A\tT5I\tmissense_variant\t196874\t0\t2\tSEA13111,SEA14318\n', 'Rv0095c\tA91V\tmissense_variant\t104944\t0\t2\t10206-03,SEA14318\n', 'Rv0081\tD99\tsynonymous_variant\t89871\t0\t2\tSEA13111,SEA14318\n', 'Rv0145_prom\tG-33T\tupstream_gene_variant\t171182\t0\t1\tSEA14318\n', 'PE_PGRS2_prom\tC-210T\tupstream_gene_variant\t149323\t0\t1\t10206-03\n', 'Rv0077c\tP67S\tmissense_variant\t86268\t0\t1\t10206-03\n', 'Rv0079\tA187\tsynonymous_variant\t88764\t0\t1\tSEA14318\n', 'Rv0133\tN36K\tmissense_variant\t160976\t0\t2\tSEA13111,SEA14318\n', 'Rv0094c\tE256D\tmissense_variant\t103896\t0\t2\tSEA13111,SEA14318\n', 'nrp\tS1125G\tmissense_variant\t113373\t0\t1\t10206-03\n', 'mce1A\tS313A\tmissense_variant\t199470\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'Rv0094c\tL257\tsynonymous_variant\t103893\t0\t2\tSEA13111,SEA14318\n', 'mce1R\tL45\tsynonymous_variant\t194681\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'fusA2\tD170E\tmissense_variant\t147262\t0\t1\tSEA14117\n', 'hycD\tL239\tsynonymous_variant\t93044\t0\t1\t10207-03\n', 'Rv0095c\tA407-408ATC\tframeshift_variant\t104808\t0\t1\tSEA14117\n', 'Rv0090\tTCGGTGTGCG684-692T\tinframe_deletion\t99162\t0\t1\tSEA14117\n', 'pntB\tL237V\tmissense_variant\t185760\t0\t1\tSEA13111\n', 'Rv0090_prom\tC-67CT\tupstream_gene_variant\t98412\t0\t1\tSEA14318\n', 'Rv0094c\tG230\tsynonymous_variant\t103974\t0\t2\tSEA13111,SEA14318\n', 'Rv0094c\tS62\tsynonymous_variant\t104478\t0\t2\tSEA13111,SEA14318\n', 'Rv0144\tE158*\tstop_gained\t170755\t0\t1\tSEA13111\n', 'Rv0139\tT175S\tmissense_variant\t166349\t0\t1\t10207-03\n', 'mce1R\tC510-511CGG\tframeshift_variant\t194305\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'mce1R\tG26D\tmissense_variant\t194739\t0\t1\tSEA14318\n', 'ephF\tG271S\tmissense_variant\t162581\t0\t1\t10206-03\n', 'PE1\tL485\tsynonymous_variant\t177857\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'Rv0095c\tQ92R\tmissense_variant\t104941\t0\t1\t10206-03\n', 'Rv0094c_prom\tC-140T\tupstream_gene_variant\t104803\t0\t1\tSEA14117\n', 'Rv0161\tL378\tsynonymous_variant\t191738\t0\t1\t10207-03\n', 'oxyS_prom\tC-985T\tupstream_gene_variant\t140215\t0\t1\t10207-03\n', 'fusA2\tQ300\tsynonymous_variant\t146872\t0\t2\tSEA13111,SEA14318\n', 'Rv0078A\tE112K\tmissense_variant\t87468\t0\t1\tSEA14117\n', 'Rv0128\tG213D\tmissense_variant\t156304\t0\t1\tSEA13111\n', 'Rv0102\tG5R\tmissense_variant\t117726\t0\t1\tSEA14117\n', 'Rv0080\tG60V\tmissense_variant\t89200\t0\t2\tSEA13111,SEA14318\n', 'Rv0104\tF160V\tmissense_variant\t122794\t0\t1\t10207-03\n', 'Rv0111\tD540E\tmissense_variant\t135569\t0\t1\t10207-03\n', 'pntAa\tL183\tsynonymous_variant\t184168\t0\t1\t10207-03\n', 'oxyS_prom\tT-1444C\tupstream_gene_variant\t139756\t0\t2\tSEA13111,SEA14318\n', 'ctpI_prom\tC-82T\tupstream_gene_variant\t130623\t0\t1\tSEA14318\n', 'PE1\tN123K\tmissense_variant\t178941\t0\t1\t10206-03\n', 'nrp\tR1833\tsynonymous_variant\t115499\t0\t2\tSEA13111,SEA14318\n', 'Rv0089_prom\tT-62C\tupstream_gene_variant\t97696\t0\t2\tSEA13111,SEA14318\n', 'Rv0094c\tG262D\tmissense_variant\t103879\t0\t1\tSEA13111\n', 'Rv0074\tTC97T\tframeshift_variant\t82843\t0\t2\tSEA13111,SEA14318\n', 'Rv0094c\tI130L\tmissense_variant\t104276\t0\t3\tSEA13111,SEA14318,SEA14117\n', 'Rv0090\tA163P\tmissense_variant\t98966\t0\t2\tSEA13111,SEA14318\n', 'Rv0094c_prom\tA-112G\tupstream_gene_variant\t104775\t0\t1\tSEA14117\n', 'fadD5\tV123A\tmissense_variant\t195360\t0\t2\tSEA13111,SEA14318\n', 'Rv0071_prom\tT-7C\tupstream_gene_variant\t79479\t0\t2\tSEA13111,SEA14318\n', 'Rv0104\tTG1425T\tframeshift_variant\t123740\t0\t2\tSEA13111,SEA14318\n', 'Rv0095c\tL120\tsynonymous_variant\t104856\t0\t1\tSEA14117\n', 'ctpB\tL22S\tmissense_variant\t122109\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'Rv0094c_prom\tC-70T\tupstream_gene_variant\t104733\t0\t1\tSEA14117\n', 'Rv0138\tI62T\tmissense_variant\t165507\t0\t1\tSEA14318\n', 'Rv0094c\tD232\tsynonymous_variant\t103968\t0\t2\tSEA13111,SEA14318\n', 'Rv0095c\tL120\tsynonymous_variant\t104858\t0\t1\tSEA14117\n', 'treS\tR313\tsynonymous_variant\t153262\t0\t1\t10207-03\n', 'pepA\tS339L\tmissense_variant\t152163\t0\t1\tSEA14318\n', 'PE3\tT14A\tmissense_variant\t188800\t0\t5\t10206-03,10207-03,SEA13111,SEA14318,SEA14117\n', 'Rv0095c\tG128A\tmissense_variant\t104833\t0\t1\tSEA14117\n']
    isolates=['SEA13111', '10206-03', '10207-03', 'SEA14117', 'SEA14318']
    bed_range=[]
    for i in range(10000, 200080, 1):
        bed_range.append(i)
    unittest.main()
